<div class="container">
  <%= render 'shared/searchbar' %>

  <h1>Liste d'activitÃ©s</h1>

  <div class="container mt-4">
    <% if @activities.any? %>
      <div class="d-grid gap-4" style="grid-template-columns: repeat(auto-fit, minmax(18rem, 1fr)); max-width: 1000px; margin: auto; justify-content: center;">
        <% @activities.each do |activity| %>
          <div class="card activity-card" style="width: 18rem; margin: auto;">

              <!-- Zone indÃ©pendante pour le cÅ“ur en haut de la carte -->
              <div class="favorite-container position-relative">
                <%= link_to toggle_activity_favorites_path(activity),
                            data: { turbo_method: :post },
                            id: "favorite_button_#{activity.id}",
                            class: "favorite-button p-2" do %>
                  <% if current_user.favorites.exists?(activity: activity) %>
                    <i class="fa-solid fa-heart text-danger"></i>
                  <% else %>
                    <i class="fa-regular fa-heart text-danger"></i>
                  <% end %>
                <% end %>
              </div>

               <div class="card-body">

              <!-- Image de l'activitÃ© (sans lien pour ne pas interfÃ©rer avec le cÅ“ur) -->
              <div class="image-container">
                <%= link_to activity_path(activity) do %>
                  <%= cl_image_tag activity.photo.key, alt: "AI-generated image of the activity", class: "card-img-top" %>
                <% end %>
              </div>

              <!-- Nom de l'activitÃ© -->
              <%= link_to activity_path(activity), class: "text-decoration-none d-block text-center mt-2" do %>
                <h2 class="h5"><%= activity.name %></h2>
              <% end %>

              <!-- IcÃ´nes de l'activitÃ© -->
              <div class="activity-icons d-flex justify-content-center gap-3 mt-3">
                <div class="circle">
                  <%= image_tag activity.image_for_setting, alt: activity.setting, class: "activity-icon" %>
                </div>
                <div class="circle"><%= activity.formatted_duration %></div>
                <div class="circle"><%= activity.formatted_age %></div>
              </div>

              <!-- Description -->
              <div class="activity-card-description mt-3">
                <p class="card-text"><%= activity.description[0..110] %>...</p>
              </div>

            </div>
          </div>
        <% end %>
      </div>
    <% else %>
      <p class="text-center mt-3">ðŸ‘€ Sorry, there are no results for your query.</p>
    <% end %>
  </div>
</div>
